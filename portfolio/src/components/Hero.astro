---
import { getProfile } from "../data/profile";
import { getLangFromUrl, useTranslations } from "../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const profile = getProfile(lang as "en" | "id");
---

<section
  id="home"
  class="relative min-h-screen flex items-center justify-center overflow-hidden"
>
  <!-- Animated Background -->
  <div class="absolute inset-0 -z-10">
    <!-- Gradient Orbs -->
    <div
      class="absolute top-1/4 left-1/4 w-64 h-64 md:w-96 md:h-96 bg-primary/20 rounded-full blur-3xl animate-float"
    >
    </div>
    <div
      class="absolute bottom-1/4 right-1/4 w-56 h-56 md:w-80 md:h-80 bg-secondary/20 rounded-full blur-3xl animate-float"
      style="animation-delay: -3s;"
    >
    </div>
    <div
      class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-80 md:w-[600px] md:h-[600px] bg-accent/10 rounded-full blur-3xl"
    >
    </div>

    <!-- Grid Pattern -->
    <div
      class="absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-size-[100px_100px]"
    >
    </div>
  </div>

  <div
    class="max-w-7xl mx-auto px-6 text-center"
    style="padding-top: 5rem; padding-bottom: 5rem;"
  >
    <!-- Greeting -->
    <div class="overflow-hidden mb-4">
      <p
        class="text-lg md:text-xl text-white/60 font-mono animate-reveal-up"
        style="animation-delay: 0.1s;"
      >
        {t("hero.greeting")}
      </p>
    </div>

    <!-- Name -->
    <div class="overflow-hidden mb-4">
      <h1
        class="text-display text-5xl md:text-7xl lg:text-8xl xl:text-9xl animate-reveal-up"
        style="animation-delay: 0.2s;"
      >
        <span class="gradient-text">{profile.name.split(" ")[0]}</span>
        <span class="text-white">
          {profile.name.split(" ").slice(1).join(" ")}</span
        >
      </h1>
    </div>

    <!-- Title -->
    <div class="overflow-hidden mb-6">
      <h2
        class="text-heading text-2xl md:text-3xl lg:text-4xl text-white/80 animate-reveal-up"
        style="animation-delay: 0.3s;"
      >
        {t("hero.title")}
      </h2>
    </div>

    <!-- Rotating Text -->
    <div class="overflow-hidden mb-8 h-12 md:h-14">
      <div
        id="rotating-text-container"
        class="animate-reveal-up"
        style="animation-delay: 0.4s;"
      >
        <p class="text-lg md:text-xl lg:text-2xl text-white/60">
          <span id="rotating-text" class="text-secondary font-medium"></span>
          <span class="animate-blink">|</span>
        </p>
      </div>
    </div>

    <!-- Tagline -->
    <div class="overflow-hidden mb-12">
      <p
        class="text-lg md:text-xl text-white/50 max-w-2xl mx-auto animate-reveal-up"
        style="animation-delay: 0.5s;"
      >
        {t("hero.description")}
      </p>
    </div>

    <!-- CTA Buttons -->
    <div
      class="flex flex-col sm:flex-row items-center justify-center gap-4 animate-fade-in-up"
      style="animation-delay: 0.6s;"
    >
      <a
        href="#projects"
        class="btn-primary group relative overflow-hidden focus-ring"
        data-cursor-hover
      >
        <span class="relative z-10">{t("hero.cta.projects")}</span>
        <div
          class="absolute inset-0 bg-linear-to-r from-primary to-primary-light opacity-0 group-hover:opacity-100 transition-opacity"
        >
        </div>
      </a>

      <a href="#contact" class="btn-secondary focus-ring" data-cursor-hover>
        {t("hero.cta.contact")}
      </a>
    </div>

    <!-- Scroll Indicator -->
    <div
      class="absolute bottom-10 left-1/2 -translate-x-1/2 animate-fade-in"
      style="animation-delay: 1s;"
    >
      <a
        href="#about"
        class="flex flex-col items-center gap-2 text-white/40 hover:text-white/60 transition-colors"
      >
        <span class="text-sm font-mono">Scroll</span>
        <div
          class="w-6 h-10 border-2 border-current rounded-full flex justify-center pt-2"
        >
          <div class="w-1 h-2 bg-current rounded-full animate-bounce"></div>
        </div>
      </a>
    </div>
  </div>
</section>

<script define:vars={{ rotatingTexts: profile.rotatingTexts }}>
  // Typewriter effect for rotating text
  const textElement = document.getElementById("rotating-text");
  let currentIndex = 0;
  let charIndex = 0;
  let isDeleting = false;
  let typingSpeed = 100;

  function typeWriter() {
    if (!textElement) return;

    const currentText = rotatingTexts[currentIndex];

    if (isDeleting) {
      textElement.textContent = currentText.substring(0, charIndex - 1);
      charIndex--;
      typingSpeed = 50;
    } else {
      textElement.textContent = currentText.substring(0, charIndex + 1);
      charIndex++;
      typingSpeed = 100;
    }

    if (!isDeleting && charIndex === currentText.length) {
      // Pause at end of word
      typingSpeed = 2000;
      isDeleting = true;
    } else if (isDeleting && charIndex === 0) {
      isDeleting = false;
      currentIndex = (currentIndex + 1) % rotatingTexts.length;
      typingSpeed = 500;
    }

    setTimeout(typeWriter, typingSpeed);
  }

  // Start typewriter effect
  setTimeout(typeWriter, 1000);
</script>

<style>
  @keyframes blink {
    0%,
    50% {
      opacity: 1;
    }
    51%,
    100% {
      opacity: 0;
    }
  }

  .animate-blink {
    animation: blink 1s infinite;
  }

  /* Light mode adjustments */
  :global(body.light) #home {
    background-color: var(--color-light-bg);
  }

  :global(body.light) #home h1 span:not(.gradient-text) {
    color: var(--color-dark-bg);
  }

  :global(body.light) #home h2 {
    color: rgba(10, 10, 10, 0.8);
  }

  :global(body.light) #home p {
    color: rgba(10, 10, 10, 0.6);
  }

  :global(body.light) #home .text-white\/60,
  :global(body.light) #home .text-white\/50,
  :global(body.light) #home .text-white\/40 {
    color: rgba(10, 10, 10, 0.5);
  }
</style>
