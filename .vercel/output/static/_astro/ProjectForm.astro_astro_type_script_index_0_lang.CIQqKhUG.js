import{C as E,c as j}from"./cmsManager.DKD_sWb_.js";import"./preload-helper.BlTxHScW.js";const o=document.getElementById("project-modal"),f=document.getElementById("project-form"),h=document.getElementById("close-project-modal"),B=document.getElementById("cancel-project-btn");document.getElementById("save-project-btn");const i=document.getElementById("project-title"),a=document.getElementById("project-slug"),r=document.getElementById("project-form-errors"),y=document.getElementById("project-error-list"),s=document.getElementById("project-form-success");let u=!1,m=null;i?.addEventListener("input",()=>{!u&&a&&(a.value=E.generateSlug(i.value))});function L(e){o&&(o.classList.remove("hidden"),o.classList.add("flex"),document.body.style.overflow="hidden",e?(u=!0,m=e.id,U(e),document.getElementById("project-modal-title").textContent="Edit Project"):(u=!1,m=null,f?.reset(),document.getElementById("project-modal-title").textContent="Create Project"),I(),i?.focus())}function d(){o&&(o.classList.add("hidden"),o.classList.remove("flex"),document.body.style.overflow="",f?.reset(),I())}function U(e){i&&(i.value=e.fields.title["en-US"]||""),a&&(a.value=e.fields.slug["en-US"]||"");const n=document.getElementById("project-description");n&&(n.value=e.fields.description["en-US"]||"");const c=document.getElementById("project-category");c&&(c.value=e.fields.category["en-US"]||"");const l=document.getElementById("project-technologies");l&&e.fields.technologies&&(l.value=e.fields.technologies["en-US"].join(", "));const t=document.getElementById("project-live-url");t&&(t.value=e.fields.liveUrl?.["en-US"]||"");const p=document.getElementById("project-source-url");p&&(p.value=e.fields.sourceUrl?.["en-US"]||"");const v=document.getElementById("project-featured");v&&(v.checked=e.fields.featured?.["en-US"]||!1)}function g(e){r&&y&&(y.innerHTML=e.map(n=>`<li>â€¢ ${n}</li>`).join(""),r.classList.remove("hidden")),s&&s.classList.add("hidden")}function w(){s&&s.classList.remove("hidden"),r&&r.classList.add("hidden")}function I(){r&&r.classList.add("hidden"),s&&s.classList.add("hidden")}async function S(){const e=new FormData(f),n=e.get("technologies")?.split(",").map(t=>t.trim()).filter(Boolean)||[],c={title:e.get("title"),slug:e.get("slug"),description:e.get("description"),category:e.get("category"),featured:e.has("featured"),technologies:n,liveUrl:e.get("liveUrl")||void 0,sourceUrl:e.get("sourceUrl")||void 0},l=E.validateProject(c);if(l.length>0){g(l);return}try{let t;u&&m?t=await j.updateContent(m,c):t=await j.createProject(c),t?(w(),setTimeout(()=>{d(),window.dispatchEvent(new CustomEvent("refreshDashboard"))},1500)):g(["Failed to save project. Please try again."])}catch(t){console.error("Error saving project:",t),g(["An unexpected error occurred. Please try again."])}}h?.addEventListener("click",d);B?.addEventListener("click",d);f?.addEventListener("submit",e=>{e.preventDefault(),S()});o?.addEventListener("click",e=>{e.target===o&&d()});window.openProjectModal=L;window.closeProjectModal=d;
